---
title: "Cervical Cancer Interpolation and Prediction"
author: 
- Antina Lee
- Joey Haymaker
- Maria Diaz Ortiz
date: "Due 12/13/2017"
output:
  html_document:
    number_sections: yes
    self_contained: yes
    toc: yes
  pdf_document:
    toc: yes
    toc_depth: 2
---

```{r, echo=FALSE, fig.align="center", out.width="300px"}
knitr::include_graphics("https://drlaurenrodgers.com/wp-content/uploads/cervical-cancer-screening.jpg")
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(leaps)
library(car)
library(glmnet)
library(tidyverse)
library(ggplot2)
library(magrittr)
library(GGally)
library(corrplot)
```

<!---=====# Table of Contents -- will automatically be included in output
__Our Objective:__ 

Predict: Dependent variable "Cervical cancer" = "Hinselmann" + "Schiller" + "Citology" + "Biopsy"

__Rational:__ "The last four features represent medical exams that determine the likelyhood of that person having cancer, as far as I know there is no feature that confirms if a person has cervical cancer in this dataset - so I approached it as a risk instead.

The target variable that I created represent groups of people with varying degrees of risk of having cervical cancer.

From my previous experience in a cancer related NGO, a single exam isn't enough to determine if a person has cancer or not - it's a big diagnostic and often more medical exams are required to determine the final diagnostic (since exams can also yield false positives and false negatives)."

=====================--->
<!---==========================--->
##Summary

##Description of the Problem

The incidence of cervical cancer in the US has decreased singnificanty over the past 40 years (from being the #1 cause of death for women in the US to being 14th in frequency), mosly due to early detection due to pap smear screening. However, it still remains a large source of morbidity and mortality both in the US and globally. In 2014, there were over 12,500 new cervical cancer diagnoses and over 4,000 cervical cancer-associated deaths in the US alone. On a global scale, cervical cancer is still the 3rd most common neoplasia and the #2 cause of cancer-related deaths among women. Cervical cancer is almost exclusively caused by the human papilloma virus (HPV), a sommon sexually transmitted disease. There are multiple subtypes of HPV, some of which are associated with warts and others which are notorious for causing cervical cancer. Although recently the US Food and Drug Administration (FDA) has approved Gardasil and Cevarix, two vaccines that protect against "high risk" types of cervical cancer, these vaccines do not protect against all types of cervical cancer. In order to further decrease the incidence of cervical cancer, it is important to understand what behavioral and demographic factors increase the risk of acquiring cervical cancer. Thus, the goal of our analysis is two-fold: 1) to identify factors that increase the risk of cervical cancer and 2) to develop a model that predicts the risk of cervical cancer.

##Description of the Data

The dataset was obtained from kaggle () and was collected through administering questionnaires to 858 patients at 'Hospital Universitario de Caracas' in Caracas, Venezuela. It includes demographic information, habits, and historic medical records of the patients in question. Missing values correspond to patients who failed to answer a question due to privacy concerns. A more detailed description of each variable is outlined below:

Demographic/behavioral variables:
  
  + `Age` (integer) - Corresponds to the age at which the patient filled the questionnaire
  + `Number.of.sexual.partners` (integer) - Numer of sexual partners
  + `First.sexual.intercourse` (integer) - Age at first sexual intercourse
  + `Num.of.pregnancies` (integer) - Number of pregnancies
  + `Smoker.status` (factor) - Categorical value that corresponds to whether someone is a non-smoker (0), light-medium smoker (1), or heavy smoker (2). 
    + This variable was generated by using the following transformation to define "pack-years": $Packyears = Smokes (yes=1, no=0) \times Smokes (years) \times Smokes (packs/year)$. Then, pack years was log transformed ($log(packyears+1)$) because, when excluding non-smokers ($log(packyears+1)=0$), the distribution for number of $log(packyears+1)$ looks more normal. We calculated the mean for this group ($mean(log(packyears+1))=2.346$) and 0-2 were assigned as follows:
        + $Non-smoker(0)$: 0 log(packyears+1)
        + $Light-Medium smoker (1)$: Between 0 and 2.346 log(packyears+1)
        + $Heavy smoker (2)$: > 2.346 log(packyears+1)
  + `log.Years.HCP` (integer)** - Generated by multiplying $Years.HCP = Hormonal.Contraceptives(yes=1,no=0) \times Hormonal.Contraceptive.Years$ then taking the log transofrmation: $log.Years.HCP = log(Years.HCP + 1)$
  + `log.Years.IUD` (integer)** - Generated by multiplying $Years.IUD = IUD(yes=1,no=0) \times IUD.Years$ then taking the log transofrmation: $log.Years.IUD = log(Years.IUD + 1)$
  
  ** The variables `log.Years.HCP` and `log.Years.IUC` were used instead of `Years.HCP` and `Years.IUD` respectively because, when you eliminate patients without HCP and IUD's, the log distributions are closer to being normally distributed (see EDA below).
  
  
Response variable:
  1) `cancerPred` (factor) - Categorical variable generated as the sum of $
 <!-- $Cervical.Cancer$ -->

### Response Variable (y)

## Data Cleaning and Preparation (EDA)


```{r, include=FALSE}
# <<< read in data >>>>
data  <- read.csv("kag_risk_factors_cervical_cancer.csv", header=TRUE, sep=",", na.strings="")
# names(data)
# View(data)
# str(data)
# dim(data) #858 x 36
# head(data, 10)
# library(data.table)
# data <- as.data.frame(lapply(data, function(x){replace(x, x == 0.0,0)}))
# head(data, 10)
# data$Smokes..years.

# <<<<<<<<<< NA VALUES >>>>>>>>>
# sum(is.na(data)) # not giving correct response
# sapply(data, function(x) sum(is.na(x)))

#<<<< ELIMINATING COLUMNS WITH EXCESSIVE 0 VALUES >>>>
summary(data) #STDs.cervical.condylomatosis [15], STDs.vaginal.condylomatosis[16],  STDs.pelvic.inflammatory.disease[19], STDs.genital.herpes[20], STDs.molluscum.contagiosum[21], STDs.HIV[23], STDs.Hepatitis.B[24], STDs.HPV[25] are not helpful columns
names(data)
data <- data[ -c(15,16,19,20,21,23,24,25) ]# getting rid of unhelpful vars
# data <- data[ -c(17) ]# getting rid of unhelpful vars
# combining above 2 lines
# data <- data[ -c("STDs.cervical.condylomatosis","STDs.vaginal.condylomatosis","STDs.pelvic.inflammatory.disease","STDs.genital.herpes","STDs.molluscum.contagiosum","STDs.HIV","STDs.Hepatitis.B","STDs.HPV") ] ## not working

# STDs..Time.since.first.diagnosis[19] & STDs..Time.since.last.diagnosis[20] have a lot of missing values as well -- removing them
names(data)
data <- data[ -c(19,20) ]# getting rid of unhelpful vars

# summary(data)
# names(data)
data <- na.omit(data)
# data <- select_if(data, is.numeric) #gets rid of too much information
summary(data)

## <<<< removing most frequent '?' entries >>>>>
data <-  data[!data$IUD == "?", ] #eliminating some ? entries
data <-  data[!data$Smokes == "?", ] #eliminating some ? entries
data <-  data[!data$STDs.syphilis == "?", ] #eliminating some ? entries

summary(data)
names(data)
dim(data) #728  28 -- cleaning got rid of ~130 entries
```

While there were many good variables that theoretically would have been good to include in our model (such as `STDs.HIV`, `STDs.Hepatitis.B`, `STDs.HPV`), many were almost purely comprised of 0 values, leaving little to be inferred from them. Consequently, they were removed from the dataset. There were a large number of '?' entries, many of which were also eliminated from the dataset. This left 728 out of the original 858 observations in the dataset.

##### Dependent variable `cancerPred`

The response variable is created from aggregating the last four features `Hinselmann`, `Schiller`, `Citology`, and `Biopsy`, as they represent medical exams that determine the likelyhood of that person having cervical cancer.

```{r, echo=FALSE}
# <<<< creating dependent variable >>>>>
# "Cervical cancer" = "Hinselmann" + "Schiller" + "Citology" + "Biopsy"
data$cancerPred <- data$Hinselmann + data$Schiller + data$Citology + data$Biopsy
# summary(data$cancerPred)
# data$cancerPred # all 0, 1, 2, 3, or 4
ggplot(data) + geom_histogram(aes(x = cancerPred), bins = 5, fill = "blue") +
  labs(title = "Histogram of aggregate cancer predictors (Hinselmann + Schiller + Citology + Biopsy)", x = "age", y = "Frequency")

# ------ Pie Chart ----
cancer.0 <- filter(data, cancerPred == 0)
# dim(cancer.0) # 635
cancer.1 <- filter(data, cancerPred == 1)
# dim(cancer.1) # 36
cancer.2 <- filter(data, cancerPred == 2)
# dim(cancer.2) # 20
cancer.3 <- filter(data, cancerPred == 3)
# dim(cancer.3) # 32
cancer.4 <- filter(data, cancerPred == 4)
# dim(cancer.4) # only 5!
slices <- c(635, 36, 20, 32, 5) 
lbls <- c("0", "1", "2", "3", "4")
pct <- round(slices/sum(slices)*100)
lbls <- paste(lbls, "-(",pct, ")") # add percents to labels 
lbls <- paste(lbls,"%",sep="") # ad % to labels 
pie(slices,labels = lbls, col=rainbow(length(lbls)),
  	main="Pie Chart of aggregate cancer predictor")
```

There are a great deal more values that equal 0 than any other value.

##### Smoking

Captured in: `Smokes`, `Smokes..years.`, `Smokes..packs.year.`

```{r, echo=FALSE}
# selecting `Smokes`, `Smokes..years.`, `Smokes..packs.year.`
# names(data)
my_data.smokes <- as.data.frame(data[, c("Smokes", "Smokes..years.", "Smokes..packs.year.")])
# my_data.contraception
# sapply(my_data.smokes, is.numeric) # none numeric for some reason

# making all applicable columns numeric
my_data.smokes$Smokes <- as.numeric(as.character(my_data.smokes$Smokes))
my_data.smokes$Smokes..years. <- as.numeric(as.character(my_data.smokes$Smokes..years.))
my_data.smokes$Smokes..packs.year.  <- as.numeric(as.character(my_data.smokes$Smokes..packs.year.))

# sapply(my_data.smokes, is.numeric)
# now all columns are numeric

# typeof(my_data$STDs..Time.since.first.diagnosis) # all rows are ints
res.smokes <- cor(my_data.smokes)

corrplot(res.smokes, type = "upper", order = "hclust", 
         tl.col = "black", tl.srt = 45)
```

All these variables are highly correlated and could be combined.

```{r, echo=FALSE}
# Smoking
# summary(data$Smokes..years.)
# summary(data$Smokes..packs.year.)
data$packyears <- as.numeric(as.character(data$Smokes)) * as.numeric(as.character(data$Smokes..years.)) *
  as.numeric(as.character(data$Smokes..packs.year.))
# summary(data$Smokes)
# summary(data$packyears)
# summary(data$packyears[-c(which(is.na(data$packyears)))])
packyears <- data$packyears
packyears <- packyears[-c(which(is.na(packyears)))]

# Distribution
hist(data$packyears)
hist(log(data$packyears+1))

# Without packyears == 0
hist(data$packyears[-c(which(data$packyears == 0))])
# summary(data$packyears[-c(which(data$packyears == 0))])
hist(log(data$packyears+1)[-c(which(log(data$packyears+1) == log(1)))]) # Looks more normal, you can split people below the mean as low-medium smokers and above the mean as heavy smokers
# summary(log(data$packyears+1)[-c(which(log(data$packyears+1) == log(1)))])

# Create Smoker.status
data$Smoker.status <- rep("1", length(data$packyears))
nonsmoker.index <- c(which(log(data$packyears+1) == 0))
heavy.index <- c(which(log(data$packyears+1) > 2.346))
na.index <- c(which(is.na(data$packyears)))
data$Smoker.status[nonsmoker.index] <- "0"
data$Smoker.status[heavy.index] <- "2"
data$Smoker.status[na.index] <- "?"
data$Smoker.status <- as.factor(data$Smoker.status)
# summary(data$Smoker.status)
```

To address the interaction between the 3 smoking variables, a categorical variable `Smoker.status` was created. This was done first by a transformation to define "pack-years": $Packyears = Smokes (yes=1, no=0) \times Smokes (years) \times Smokes (packs/year)$. Then, pack years was log transformed ($log(packyears+1)$) because, when excluding non-smokers ($log(packyears+1)=0$), the distribution for number of $log(packyears+1)$ looks more normal (as seen above). Finally, the mean was calculated for the group ($mean(log(packyears+1))=2.346$) and 0-2 were assigned as follows:
        + $Non-smoker(0)$: 0 log(packyears+1)
        + $Light-Medium smoker (1)$: Between 0 and 2.346 log(packyears+1)
        + $Heavy smoker (2)$: > 2.346 log(packyears+1)
        
```{r, include=FALSE}
# removing "Smokes"[5], "Smokes..years."[6],Smokes..packs.year."[7], & "packyears"[28] from df, as Smoker.status captures all that
names(data)
data <- data[-c(5:7, 28)]
names(data)
```

The original smoking variables (`Smokes`, `Smokes..years.`, `Smokes..packs.year.`, `packyears`) were then removed fromt the dataset.

##### `Age` -> `logAge`

```{r, echo=FALSE}
ggplot(data) + geom_histogram(aes(x = Age), bins = 25, fill = "blue") +
  labs(title = "Histogram of participant ages", x = "age", y = "Frequency")

#<<< creating log age column >>>
data$logAge <- log(data$Age)
ggplot(data) + geom_histogram(aes(x = logAge), bins = 25, fill = "blue") +
  labs(title = "Histogram of participant ages (log)", x = "age", y = "Frequency")

# removing original age column
data <- data[,-1]
# names(data)
```

We can see the respondents' ages are skewed, with the majority of participants falling in the 20-40 age range. There is a conspicuos gap in representation, specifically in teh 60-70 age range, as well as 70-80 age range. 

Taking the natural log of the age results in a more normal distribution.

##### Sexual activity

Since the human papilloma virus (HPV) is the main risk factor for cervical cancer it makes sense to investigate variables that speak to this. From the data provided, sexual activity indicators are most salient, as HPV is contracted via sexual activity with an infected person.

```{r, echo=FALSE}
# "Number.of.sexual.partners" 
# data %>% select(Number.of.sexual.partners) %>% distinct() # get distinct values for # partners column

# making numeric
data$Number.of.sexual.partners <- as.numeric(as.character(data$Number.of.sexual.partners))
# data %>% select(Number.of.sexual.partners) %>% distinct()
# summary(data$Number.of.sexual.partners)

ggplot(data) + geom_histogram(aes(x = Number.of.sexual.partners), bins = 20, fill = "green") +
  labs(title = "Histogram of num. of sexual partners", x = "Num. of partners", y = "Frequency")
```

Slightly skewed, but not terribly so. 

```{r, echo=FALSE}
# "First.sexual.intercourse"  
# data %>% select(First.sexual.intercourse) %>% distinct()
# ggplot(data) + geom_histogram(aes(x = First.sexual.intercourse), bins = 10, fill = "red") +
  # labs(title = "Histogram of num. of sexual partners", x = "Num. of partners", y = "Frequency")

ggplot(data, aes(x = First.sexual.intercourse, fill = factor(cancerPred))) +
    geom_bar(stat = "count") +
    xlab("Age of first sexual intercourse") +
    ylab("Total count") +
    labs(fill = "Cancer predictor value")
```

We can see that these values have a good normal distribution, and the dependent variable values seem to follow the data, indicating this may be an important factor in predicting the outcome.

```{r, echo=FALSE}
# "Num.of.pregnancies"
# data %>% select(Num.of.pregnancies) %>% distinct()

ggplot(data, aes(x = Num.of.pregnancies, fill = factor(cancerPred))) +
    geom_bar(stat = "count") +
    xlab("Number of pregnancies") +
    ylab("Total count") +
    labs(fill = "Cancer predictor value")
```

Exhibits normal distribution, and dependent variable slightly follows the data.

##### HPV

```{r, echo=FALSE}
# names(data)
# data %>% select(Dx.HPV) %>% distinct() # categorical

# ------ breakdown of cancerPred value for all respondents who have HPV == 1 ----
hpv.y0 <- filter(data, Dx.HPV == 1, cancerPred == 0)
# dim(hpv.y0) # only 8
hpv.y1 <- filter(data, Dx.HPV == 1, cancerPred == 1)
# dim(hpv.y1) # 2
hpv.y2 <- filter(data, Dx.HPV == 1, cancerPred == 2)
# dim(hpv.y2) # 1
hpv.y3 <- filter(data, Dx.HPV == 1, cancerPred == 3)
# dim(hpv.y3) # 4
hpv.y4 <- filter(data, Dx.HPV == 1, cancerPred == 4)
# dim(hpv.y4) # 1

slices.hpv <- c(8, 2, 1, 4, 1)
lbls.hpv <- c("cancer pred. 0", "cancer pred. 1", "cancer pred. 2", "cancer pred. 3", "cancer pred. 4")
pct.hpv <- round(slices.hpv/sum(slices.hpv)*100)
lbls.hpv <- paste(lbls.hpv, "-(", pct.hpv, ")")
lbls.hpv <- paste(lbls.hpv, "%", sep="")

pie(slices.hpv,labels = lbls.hpv, col=rainbow(length(lbls.hpv)),
  	main="Pie Chart of cancer predictor values for patients with HPV")

# ------------ cancerPred for all repsondents HPV == 0 ---------
hpv0.y0 <- filter(data, Dx.HPV == 0, cancerPred == 0)
# dim(hpv0.y0) # 627
hpv0.y1 <- filter(data, Dx.HPV == 0, cancerPred == 1)
# dim(hpv0.y1) # 34
hpv0.y2 <- filter(data, Dx.HPV == 0, cancerPred == 2)
# dim(hpv0.y2) # 19
hpv0.y3 <- filter(data, Dx.HPV == 0, cancerPred == 3)
# dim(hpv0.y3) # 28
hpv0.y4 <- filter(data, Dx.HPV == 0, cancerPred == 4)
# dim(hpv0.y4) # 4

slices.hpv0 <- c(627, 34, 19, 28, 4)
lbls.hpv0 <- c("cancer pred. 0", "cancer pred. 1", "cancer pred. 2", "cancer pred. 3", "cancer pred. 4")
pct.hpv0 <- round(slices.hpv0/sum(slices.hpv0)*100)
lbls.hpv0 <- paste(lbls.hpv0, "-(", pct.hpv0, ")")
lbls.hpv0 <- paste(lbls.hpv0, "%", sep="")

pie(slices.hpv0,labels = lbls.hpv0, col=rainbow(length(lbls.hpv0)),
  	main="Pie Chart of cancer predictor values for patients without HPV")
```

These pie graphs confirm our review of literature, showing that patients with HPV show a higher prevalence of cervical cancer markers.


<!----------------Multicollinearity--------------------->
### Multicollinearity across variables

##### Sexual history

Captured in: `Number.of.sexual.partners`, `First.sexual.intercourse`, `Num.of.pregnancies`

```{r, echo=FALSE}
# install.packages("corrplot")
library(corrplot)
# Use corrplot() to create a correlogram:
# The function corrplot() takes the correlation matrix as the first argument. The second argument (type=“upper”) is used to display only the upper triangular of the correlation matrix.

# selecting `Number.of.sexual.partners`, `First.sexual.intercourse`, `Num.of.pregnancies`
# names(data)
my_data.sxhistory <- as.data.frame(data[, c("Number.of.sexual.partners", "First.sexual.intercourse", "Num.of.pregnancies")])
# my_data.contraception
# sapply(my_data.sxhistory, is.numeric) # none numeric for some reason

# making all applicable columns numeric
my_data.sxhistory$Number.of.sexual.partners <- as.numeric(my_data.sxhistory$Number.of.sexual.partners)
my_data.sxhistory$First.sexual.intercourse <- as.numeric(my_data.sxhistory$First.sexual.intercourse)
my_data.sxhistory$Num.of.pregnancies  <- as.numeric(my_data.sxhistory$Num.of.pregnancies)

# my_data.sxhistory$Number.of.sexual.partners <- na.omit(my_data.sxhistory$Number.of.sexual.partners)
my_data.sxhistory <-  na.omit(my_data.sxhistory)
# sapply(my_data.sxhistory, is.numeric)
# now all columns are numeric

# typeof(my_data$STDs..Time.since.first.diagnosis) # all rows are ints
res.sxhistory <- cor(my_data.sxhistory)

corrplot(res.sxhistory, type = "upper", order = "hclust", 
         tl.col = "black", tl.srt = 45)
```

These variables are relatively uncorrelated, and thus can remain as they are.


##### Contraception - Hormonal contraceptives & IUDs

Captured in: `Hormonal.Contraceptives`, `Hormonal.Contraceptives..years.`, `IUD`, `IUD..years.`

```{r, echo=FALSE}
# selecting `Hormonal.Contraceptives`, `Hormonal.Contraceptives..years.`, `IUD`, `IUD..years.`
# names(data)
my_data.contraception <- as.data.frame(data[, c("Hormonal.Contraceptives", "Hormonal.Contraceptives..years.", "IUD", "IUD..years.")])
# my_data.contraception
# sapply(my_data.contraception, is.numeric) # none numeric for some reason

# making all applicable columns numeric
my_data.contraception$Hormonal.Contraceptives <- as.numeric(my_data.contraception$Hormonal.Contraceptives)
my_data.contraception$Hormonal.Contraceptives..years. <- as.numeric(my_data.contraception$Hormonal.Contraceptives..years.)
my_data.contraception$IUD  <- as.numeric(my_data.contraception$IUD)
my_data.contraception$IUD..years. <- as.numeric(my_data.contraception$IUD..years.)
# sapply(my_data.contraception, is.numeric)
# now all columns are numeric

# typeof(my_data$STDs..Time.since.first.diagnosis) # all rows are ints
res.contraception <- cor(my_data.contraception)

corrplot(res.contraception, type = "upper", order = "hclust", 
         tl.col = "black", tl.srt = 45)
```

Results indicate that we should combine `IUD`/`IUD..years.`, and `Hormonal.Contraceptives`/`Hormonal.Contraceptives..years.`.

```{r, echo=FALSE}
# Hormonal contraceptives
# str(data)
# summary(data$Hormonal.Contraceptives)
# summary(data$Hormonal.Contraceptives..years.)
# Create Years.HCP
data$Years.HCP <- as.numeric(as.character(data$Hormonal.Contraceptives)) * 
  as.numeric(as.character(data$Hormonal.Contraceptives..years.))
# summary(data$Years.HCP)
# Histogram HCP
hist(data$Years.HCP[-c(which(is.na(data$Years.HCP)))]) 
# Histogram log(HCP+1)
hist(log(data$Years.HCP[-c(which(is.na(data$Years.HCP)))]+1))   
# The log transformed data should be closer to normal is you remove first peak
log.years.hcp <- log(data$Years.HCP[-c(which(is.na(data$Years.HCP)))]+1)
log.years.hcp <- log.years.hcp[-c(which(log.years.hcp == log(1)))]
# hist(data$log.years.hcp)
# Create log.Years.HCP
data$log.Years.HCP <- log(data$Years.HCP+1)
# summary(data$log.Years.HCP)


# IUD's
# summary(data$IUD)
# summary(data$IUD..years.)
# Create Years.IUD
data$Years.IUD <- as.numeric(as.character(data$IUD)) * as.numeric(as.character(data$IUD..years.))
# summary(data$Years.IUD)
# Histogram IUD
# data$Years.IUD  
hist(data$Years.IUD[c(which(!is.na(data$Years.IUD)))]) 
# Histogram log(IUD+1)
hist(log(data$Years.IUD[c(which(!is.na(data$Years.IUD)))]+1))  
# The log transformed data should be closer to normal is you remove first peak
log.years.iud <- log(data$Years.IUD[c(which(!is.na(data$Years.IUD)))]+1)
log.years.iud <- log.years.iud[-c(which(log.years.iud == log(1)))]
hist(log.years.iud)
# Create log.Years.IUD
data$log.Years.IUD <- log(data$Years.IUD+1)
# summary(data$log.Years.IUD)
```

Similarly to `Smoker.status`, two new variables were created from the four original correlated variables. `log.Years.HCP` was created by multiplying $Years.HCP = Hormonal.Contraceptives(yes=1,no=0) \times Hormonal.Contraceptive.Years$ then taking the log transofrmation: $log.Years.HCP = log(Years.HCP + 1)$. The histograms before and after this process can be seen above. `log.Years.IUD` was created by multiplying $Years.IUD = IUD(yes=1,no=0) \times IUD.Years$, then taking the log transofrmation: $log.Years.IUD = log(Years.IUD + 1)$. As expected the histograms of the log transformed variables show a much better distribution than the originals.

```{r, include=FALSE}
# removing 4 original variables - `Hormonal.Contraceptives`[4], `Hormonal.Contraceptives..years.`[5], `IUD`[6], `IUD..years.`[7], "Years.HCP"[26], 
# names(data)
data <- data[-c(4:7,26)]
names(data)
# missed Years.IUD
data <- data[-c(23)]
names(data)
```

The preliminary variables `Hormonal.Contraceptives`, `Hormonal.Contraceptives..years.`, `IUD`, `IUD..years.`, `Years.HCP`, and `Years.IUD` were then removed from the dataframe in lieu of the log values.

##### STIs

Captured in: `STDs`, `STDs..number.`, `STDs.condylomatosis`, `STDs.vulvo.perineal.condylomatosis`, `STDs.syphilis`, `STDs..Number.of.diagnosis`

```{r, echo=FALSE}
# selecting `STDs`[12], `STDs..number.`[13], `STDs.condylomatosis`[14], `STDs.vulvo.perineal.condylomatosis`[15], `STDs.syphilis`[16], `STDs..Number.of.diagnosis`[17], `STDs..Time.since.first.diagnosis`[18]
# names(data)
# data$std
my_data <- as.data.frame(data[, c("STDs", "STDs..number.", "STDs.condylomatosis", "STDs.vulvo.perineal.condylomatosis", "STDs.syphilis", "STDs..Number.of.diagnosis")])
# my_data
# sapply(my_data, is.numeric) # many not numeric for some reason

# making all applicable columns numeric
my_data$STDs <- as.numeric(as.character(my_data$STDs))
my_data$STDs..number. <- as.numeric(as.character(my_data$STDs..number.))
my_data$STDs.condylomatosis  <- as.numeric(as.character(my_data$STDs.condylomatosis))
my_data$STDs.vulvo.perineal.condylomatosis <- as.numeric(as.character(my_data$STDs.vulvo.perineal.condylomatosis))
my_data$STDs.syphilis <- as.numeric(as.character(my_data$STDs.syphilis))
# sapply(my_data, is.numeric)
# now all columns are numeric

# typeof(my_data$STDs..Time.since.first.diagnosis) # all rows are ints
res <- cor(my_data)

corrplot(res, type = "upper", order = "hclust", 
         tl.col = "black", tl.srt = 45)
```

Unsurprsingly, there exists high correlation between many of these variables. To address this, we remove those with high correlation. As the figure shows, all variables except `STDs.syphilis` are highly correlated with `STDs.condylomatosis`. Consequently we leave those that are uncorrelated (`STDs.syphilis`, and `STDs.condylomatosis`) in the model, and remove the rest.

```{r, include=FALSE}
names(data)
summary(data)
data <- data[-c(4,5,7,9,10)]
names(data)
```

```{r, include=FALSE}
# finally, removing "Hinselmann" "Schiller","Citology", "Biopsy" -- all in cancerPred 
data <- data[-c(10:13)]
names(data)
```


<!-- NOT WORKING-- ignore this 
Combining STI data via PCA
```{r, eval=FALSE, include=FALSE}
data.PCA.STI <- data[c("STDs", "STDs..number.", "STDs.condylomatosis", "STDs.vulvo.perineal.condylomatosis", "STDs.syphilis", "STDs..Number.of.diagnosis")] # no sampling
# data.PCA.STI
# data.PCA.STI <- as.numeric((data.PCA.STI))
data.PCA.STI
View(data.PCA.STI)
data.PCA.STI.scale <- scale(data.PCA.STI, center=TRUE, scale=TRUE)
# summary(data.PCA.STI.scale)
data.PCA.STI.scale <- as.data.frame(data.PCA.STI.scale)
pc.STI <- prcomp(data.PCA.STI, scale = TRUE)
names(pc.STI)
summary(pc.STI)
#                           PC1    PC2    PC3     PC4
# Standard deviation     1.5713 0.9225 0.6598 0.49466
# Proportion of Variance 0.6172 0.2128 0.1088 0.06117
# Cumulative Proportion  0.6172 0.8300 0.9388 1.00000

#PC1 scores
phi1.STI <- pc.STI$rotation[,1]
phi1.STI
# Hinselmann   Schiller   Citology     Biopsy 
#  0.5000567  0.5793741  0.3358205  0.5490843 
Z1.STI <- pc.STI$x[,1]
length(Z1.STI) #728

# PC2 scores
Z2.STI <- pc.STI$x[,2]
```
-->

<!----------------END Multicollinearity--------------------->




<!--- modeling - logistic regression --->
## Model Description
### Logistic Regression Overview
### Logistic Regression Results
<!--- modeling - logistic regression --->




<!--- modeling - alternative methods --->
## Alternative Methods
### Overview of Boosting Method
### Results of Boosting Method

### Using PCA for interaction variables

<!-- doesn't really make much sense 
```{r, eval = FALSE}
summary(data)
# Smokes        Smokes..years.   Smokes..packs.year
# data.PCA <- data[sample(nrow(data), 400, replace = FALSE), c("Hinselmann", "Schiller", "Citology", "Biopsy")] # sampling
data.PCA <- data[c("Hinselmann", "Schiller", "Citology", "Biopsy")] # no sampling
# data.PCA
data.PCA.scale <- scale(data.PCA, center=TRUE, scale=TRUE)
# summary(data.PCA.scale)
data.PCA.scale <- as.data.frame(data.PCA.scale)
pc.4 <- prcomp(data.PCA, scale = TRUE)
names(pc.4)
summary(pc.4)
#                           PC1    PC2    PC3     PC4
# Standard deviation     1.5713 0.9225 0.6598 0.49466
# Proportion of Variance 0.6172 0.2128 0.1088 0.06117
# Cumulative Proportion  0.6172 0.8300 0.9388 1.00000

#PC1 scores
phi1 <- pc.4$rotation[,1]
phi1
# Hinselmann   Schiller   Citology     Biopsy 
#  0.5000567  0.5793741  0.3358205  0.5490843 
Z1 <- pc.4$x[,1]
length(Z1) #728

# PC2 scores
Z2 <- pc.4$x[,2]
```

```{r, eval = FALSE}
# Plots
pve.4 <- 100 * (pc.4$sdev)^2/sum((pc.4$sdev)^2)
plot(pve.4, pch=16,
     xlab = "Principal Components",
     ylab = "Prop. of variance explained")

# PVE
cpve.4 <- 100*cumsum((pc.4$sdev)^2)/4
plot(seq(1:4), cpve.4, pch=16, ylim=c(0,100),
     main="Cumulative proportion of variance explained",
     xlab = "Number of PC's Used")

# Biplot
lim <- c(-.4, .4)
biplot(pc.4, xlim=lim,
       ylim=lim,
       main="Biplot of the PC's")
abline(v=0, h=0)


```

```{r, echo=FALSE, eval = FALSE}
biplot(pc.4, expand=10, xlim=c(0, 0.2), ylim=c(-.2, .35))
abline(v=0, h=0)
```
-->


<!--- modeling - alternative methods --->


## Comparison of Methods

## Validity of Results and Future Improvement

## Conclusion

## Appendix

### Original variable descriptions

#### Demographic

+ `Age` - (int) Age
+ `Smokes` - (bool) Smokes
+ `Smokes..years.` - Smokes (years)
+ `Smokes..packs.year.` - Smokes (packs/year)

#### Contraception

+ `Hormonal.Contraceptives` - (bool) Hormonal Contraceptives
+ `Hormonal.Contraceptives..years.` - (int) Hormonal Contraceptives (years)
+ `IUD` - (bool) IUD (Intrauterine device)
+ `IUD..years.` - (int) IUD (years)

#### Sexual activity history

+ `Number.of.sexual.partners` - (int) Number of sexual partners
+ `First.sexual.intercourse` - (int) First sexual intercourse (age)
+ `Num.of.pregnancies` - (int) Num of pregnancies

#### Sexual health history

+ `STDs` - (bool) STDs
+ `STDs..number.` - (int) STDs (number)
+ `STDs.condylomatosis` - (bool) STDs:condylomatosis
+ `STDs.cervical.condylomatosis` - (bool) STDs:cervical condylomatosis
+ `STDs.vaginal.condylomatosis` - (bool) STDs:vaginal condylomatosis
+ `STDs.vulvo.perineal.condylomatosis` - (bool) STDs:vulvo-perineal condylomatosis
+ `STDs.syphilis` - (bool) STDs:syphilis
+ `STDs.pelvic.inflammatory.disease` - (bool) STDs:pelvic inflammatory disease
+ `STDs.genital.herpes` - (bool) STDs:genital herpes
+ `STDs.molluscum.contagiosum` - (bool) STDs:molluscum contagiosum
+ `STDs.AIDS` - (bool) STDs:AIDS
+ `STDs.HIV` - (bool) STDs:HIV
+ `STDs.Hepatitis.B` - (bool) STDs:Hepatitis B
+ `STDs.HPV` - (bool) STDs:HPV
+ `STDs..Number.of.diagnosis` - (int) STDs: Number of diagnosis
+ `STDs..Time.since.first.diagnosis` - (int) STDs: Time since first diagnosis
+ `STDs..Time.since.last.diagnosis` - (int) STDs: Time since last diagnosis

#### Medical history

+ `Dx.Cancer` - (bool) Dx:Cancer (person had previous cervical cancer diagnostic)
+ `Dx.CIN` - (bool) Dx:CIN (person had previous diagnostic of Cervical intraepithelial neoplasia - the potentially premalignant transformation and abnormal growth (dysplasia) of squamous cells on the surface of the cervix)
+ `Dx.HPV` - (bool) Dx:HPV
+ `Dx` - (bool) Dx
+ `Hinselmann` - (bool) Hinselmann: target variable
+ `Schiller` - (bool) Schiller: target variable
+ `Citology` - (bool) Cytology: target variable
+ `Biopsy` - (bool) Biopsy: target variable





